import{u as useAuth,c as collaborationAPI,j as jsxRuntimeExports,a as ModernCard,M as ModernButton,m as motion}from"./index-lko4Hfbd.js";import{r as reactExports}from"./vendor-WBEadHvS.js";import{c as useParams,u as useNavigate}from"./router-BTz3HJhu.js";import{b as Loader2,A as AlertTriangle,C as Check,k as Users,g as MapPin,m as Calendar,X}from"./ui-B24o0VU9.js";const CollaborationAcceptPage=()=>{const{invitationToken}=useParams(),navigate=useNavigate(),{isAuthenticated}=useAuth(),[invitation,setInvitation]=reactExports.useState(null),[isLoading,setIsLoading]=reactExports.useState(!0),[isProcessing,setIsProcessing]=reactExports.useState(!1),[error,setError]=reactExports.useState(null),[success,setSuccess]=reactExports.useState(!1),[action,setAction]=reactExports.useState(null);reactExports.useEffect(()=>{if(!invitationToken){setError("Invalid invitation link"),setIsLoading(!1);return}if(!isAuthenticated){const returnUrl=`/collaboration/accept/${invitationToken}`;navigate("/login",{state:{from:returnUrl,message:"Please log in to accept the collaboration invitation"}});return}loadInvitation()},[invitationToken,isAuthenticated,navigate]);const loadInvitation=async()=>{try{setIsLoading(!0),setError(null);const result=await collaborationAPI.getInvitationInfo(invitationToken);setInvitation(result.data)}catch(err){console.error("Error loading invitation:",err),setError(err.message||"Failed to load invitation")}finally{setIsLoading(!1)}},handleAccept=async()=>{if(invitationToken)try{setIsProcessing(!0),setAction("accept");const response=await collaborationAPI.acceptInvitation(invitationToken);setSuccess(!0),setTimeout(()=>{var _a;const newItineraryId=((_a=response.data)==null?void 0:_a.itinerary_id)||invitation.itinerary.id;navigate(`/saved-itinerary/${newItineraryId}`)},2e3)}catch(err){console.error("Error accepting invitation:",err),setError(err.message||"Failed to accept invitation"),setIsProcessing(!1),setAction(null)}},handleDecline=async()=>{if(invitationToken)try{setIsProcessing(!0),setAction("decline"),await collaborationAPI.declineInvitation(invitationToken),setSuccess(!0),setTimeout(()=>{navigate("/dashboard")},2e3)}catch(err){console.error("Error declining invitation:",err),setError(err.message||"Failed to decline invitation"),setIsProcessing(!1),setAction(null)}},getRoleIcon=role=>{switch(role){case"admin":return jsxRuntimeExports.jsx(Users,{className:"w-5 h-5 text-purple-600"});case"editor":return jsxRuntimeExports.jsx(Users,{className:"w-5 h-5 text-green-600"});case"viewer":return jsxRuntimeExports.jsx(Users,{className:"w-5 h-5 text-blue-600"});default:return jsxRuntimeExports.jsx(Users,{className:"w-5 h-5 text-gray-600"})}},getRoleColor=role=>{switch(role){case"admin":return"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400";case"editor":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"viewer":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"}},formatDate=dateString=>new Date(dateString).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return isLoading?jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center p-4",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(Loader2,{className:"w-6 h-6 animate-spin text-blue-600 mx-auto mb-3"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Loading invitation..."})]})}):error?jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center p-4",children:jsxRuntimeExports.jsxs(ModernCard,{className:"p-6 max-w-sm w-full text-center",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-12 h-12 text-red-500 mx-auto mb-3"}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:"Invalid Invitation"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:error}),jsxRuntimeExports.jsx(ModernButton,{onClick:()=>navigate("/dashboard"),variant:"solid",size:"md",children:"Go to Dashboard"})]})}):success?jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center p-4",children:jsxRuntimeExports.jsxs(ModernCard,{className:"p-6 max-w-sm w-full text-center",children:[jsxRuntimeExports.jsx(Check,{className:"w-12 h-12 text-green-500 mx-auto mb-3"}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:action==="accept"?"Invitation Accepted!":"Invitation Declined"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:action==="accept"?"You are now a collaborator on this itinerary. Redirecting...":"You have declined the collaboration invitation. Redirecting..."}),jsxRuntimeExports.jsx(Loader2,{className:"w-5 h-5 animate-spin text-blue-600 mx-auto"})]})}):invitation?jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center p-4",children:jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"w-full max-w-lg",children:jsxRuntimeExports.jsxs(ModernCard,{className:"p-6 shadow-xl border-0 bg-white/95 dark:bg-gray-800/95 backdrop-blur-sm",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-6",children:[jsxRuntimeExports.jsx(motion.div,{initial:{scale:.8},animate:{scale:1},transition:{duration:.5,delay:.2},className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:jsxRuntimeExports.jsx(Users,{className:"w-8 h-8 text-white"})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Collaboration Invitation"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"You've been invited to collaborate on a travel itinerary"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start space-x-3",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-lg flex items-center justify-center flex-shrink-0",children:invitation.itinerary.cover_image?jsxRuntimeExports.jsx("img",{src:invitation.itinerary.cover_image,alt:invitation.itinerary.title,className:"w-full h-full object-cover rounded-lg"}):jsxRuntimeExports.jsx(MapPin,{className:"w-8 h-8 text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:invitation.itinerary.title}),jsxRuntimeExports.jsxs("div",{className:"space-y-1.5 text-xs text-gray-600 dark:text-gray-400",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx(MapPin,{className:"w-3 h-3"}),jsxRuntimeExports.jsx("span",{children:invitation.itinerary.destination})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx(Users,{className:"w-3 h-3"}),jsxRuntimeExports.jsxs("span",{children:["Invited by ",jsxRuntimeExports.jsx("strong",{children:invitation.owner_email})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx(Calendar,{className:"w-3 h-3"}),jsxRuntimeExports.jsxs("span",{children:["Expires ",formatDate(invitation.invitation.expires_at)]})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-2",children:jsxRuntimeExports.jsxs("span",{className:`inline-flex items-center space-x-1.5 px-2.5 py-1 text-xs font-medium rounded-full ${getRoleColor(invitation.invitation.role)}`,children:[getRoleIcon(invitation.invitation.role),jsxRuntimeExports.jsx("span",{className:"capitalize",children:invitation.invitation.role})]})})]})]}),invitation.invitation.message&&jsxRuntimeExports.jsxs("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-blue-800 dark:text-blue-200",children:jsxRuntimeExports.jsx("strong",{children:"Personal Message:"})}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-1 italic",children:['"',invitation.invitation.message,'"']})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[jsxRuntimeExports.jsxs(ModernButton,{onClick:handleDecline,variant:"bordered",size:"md",disabled:isProcessing,className:"flex items-center justify-center space-x-2 text-red-600 border-red-200 hover:bg-red-50",children:[isProcessing&&action==="decline"?jsxRuntimeExports.jsx(Loader2,{className:"w-4 h-4 animate-spin"}):jsxRuntimeExports.jsx(X,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:"Decline"})]}),jsxRuntimeExports.jsxs(ModernButton,{onClick:handleAccept,variant:"solid",size:"md",disabled:isProcessing,className:"flex items-center justify-center space-x-2 bg-green-600 hover:bg-green-700",children:[isProcessing&&action==="accept"?jsxRuntimeExports.jsx(Loader2,{className:"w-4 h-4 animate-spin"}):jsxRuntimeExports.jsx(Check,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:"Accept Invitation"})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-yellow-800 dark:text-yellow-200",children:[jsxRuntimeExports.jsx("strong",{children:"Security Note:"})," This invitation is unique to you and will expire in 7 days. If you didn't expect this invitation, you can safely decline it."]})})]})})}):null};export{CollaborationAcceptPage as default};
