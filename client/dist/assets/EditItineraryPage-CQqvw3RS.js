import{u as useAuth,j as jsxRuntimeExports,L as LoadingSpinner,g as ModernHeader,M as ModernButton,s as savedItineraryAPI}from"./index-lko4Hfbd.js";import{r as reactExports,b as React}from"./vendor-WBEadHvS.js";import{C as Card}from"./Card-BWSuOQqg.js";import{A as AdditionalPlaces,P as PlaceDetailsModal}from"./AdditionalPlaces-C2L1Yjet.js";import{C as CollaborationChat}from"./CollaborationChat-Ct4laSpB.js";import{a as useLocation,u as useNavigate}from"./router-BTz3HJhu.js";import{e as ArrowLeft,ad as PenLine,m as Calendar,l as Star,am as Save,g as MapPin,a2 as Plus,f as Clock,aw as Replace,ae as Trash2,Q as DollarSign,v as Search,X,c as CheckCircle}from"./ui-B24o0VU9.js";import"./useChatCollaboration-D85aFU32.js";const EditItineraryPage=()=>{var _a,_b;const location=useLocation(),navigate=useNavigate(),{user,isAuthenticated}=useAuth(),[itineraryData,setItineraryData]=reactExports.useState(null),[daySchedules,setDaySchedules]=reactExports.useState([]),[isLoading,setIsLoading]=reactExports.useState(!0),[error,setError]=reactExports.useState(null),[selectedDay,setSelectedDay]=reactExports.useState(1),[isScrolled,setIsScrolled]=reactExports.useState(!1),[isSaving,setIsSaving]=reactExports.useState(!1),[showSaveConfirmation,setShowSaveConfirmation]=reactExports.useState(!1),[selectedPlace]=reactExports.useState(null),[isPlaceModalOpen,setIsPlaceModalOpen]=reactExports.useState(!1),[showAddPlaceModal,setShowAddPlaceModal]=reactExports.useState(!1),[selectedEventToReplace,setSelectedEventToReplace]=reactExports.useState(null),[searchQuery,setSearchQuery]=reactExports.useState(""),[editMode,setEditMode]=reactExports.useState("building"),[originalItineraryId,setOriginalItineraryId]=reactExports.useState(null),currentDay=React.useMemo(()=>daySchedules.find(day=>day.day===selectedDay),[daySchedules,selectedDay]),handleDaySelect=React.useCallback(day=>{setSelectedDay(day)},[]);reactExports.useEffect(()=>{const state=location.state;if(state!=null&&state.itineraryData){setItineraryData(state.itineraryData);const isSavedItinerary=state.itineraryData&&state.itineraryData.id&&state.itineraryData.days,isBuildingPhase=state.itineraryData&&state.itineraryData.itinerary&&state.itineraryData.itinerary.daily_plans;state.isEditing||isSavedItinerary?(setEditMode("saved"),setOriginalItineraryId(state.itineraryData.id),console.log("Edit mode: Saved itinerary edit",{id:state.itineraryData.id})):isBuildingPhase?(setEditMode("building"),setOriginalItineraryId(null),console.log("Edit mode: Building phase edit")):(setEditMode("building"),setOriginalItineraryId(null),console.log("Edit mode: Default to building phase")),state.daySchedules?setDaySchedules(state.daySchedules):processItineraryData(state.itineraryData)}else setError("No itinerary data found");setIsLoading(!1)},[location.state]),reactExports.useEffect(()=>{const handleScroll=()=>{const scrollTop=window.pageYOffset||document.documentElement.scrollTop;setIsScrolled(scrollTop>100)};return window.addEventListener("scroll",handleScroll),()=>window.removeEventListener("scroll",handleScroll)},[]);const processItineraryData=data=>{console.log("Processing itinerary data:",data);const isEnhancedResponse=data&&data.itinerary&&data.itinerary.daily_plans,isSavedItinerary=data&&data.days&&Array.isArray(data.days);if(!isEnhancedResponse&&!isSavedItinerary){console.error("Invalid itinerary data structure:",data),console.error("Data structure breakdown:",{hasData:!!data,hasItinerary:!!(data&&data.itinerary),hasDailyPlans:!!(data&&data.itinerary&&data.itinerary.daily_plans),hasDays:!!(data&&data.days),dataKeys:data?Object.keys(data):"no data",itineraryKeys:data&&data.itinerary?Object.keys(data.itinerary):"no itinerary"});const errorMessage=data?`Invalid itinerary data structure. Expected either:
          - EnhancedItineraryResponse with data.itinerary.daily_plans
          - SavedItinerary with data.days array
          Received keys: ${Object.keys(data).join(", ")}`:"No itinerary data provided";setError(errorMessage);return}const dailyPlans=isEnhancedResponse?data.itinerary.daily_plans:data.days,itineraryData2=isEnhancedResponse?data.itinerary:data,placeDetails=isEnhancedResponse?data.place_details:{},schedules=dailyPlans.map(plan=>{var _a2,_b2,_c,_d,_e,_f,_g,_h,_i,_j;const events=[];return plan.day===1&&events.push({time:"12:00",type:"checkin",title:"Hotel Check-in",description:"Arrive at your accommodation",location:((_b2=(_a2=itineraryData2.accommodation_suggestions)==null?void 0:_a2[0])==null?void 0:_b2.location)||"Hotel",cost:"0",placeId:(_d=(_c=itineraryData2.accommodation_suggestions)==null?void 0:_c[0])==null?void 0:_d.place_id}),(plan.day===itineraryData2.total_days||plan.day===itineraryData2.duration_days)&&events.push({time:"09:00",type:"checkout",title:"Hotel Check-out",description:"Depart from your accommodation",location:((_f=(_e=itineraryData2.accommodation_suggestions)==null?void 0:_e[0])==null?void 0:_f.location)||"Hotel",cost:"0",placeId:(_h=(_g=itineraryData2.accommodation_suggestions)==null?void 0:_g[0])==null?void 0:_h.place_id}),(_i=plan.activities)==null||_i.forEach(activity=>{const activityPlaceDetails=placeDetails==null?void 0:placeDetails[activity.place_id];events.push({time:activity.time,type:"activity",title:activity.title,description:(activityPlaceDetails==null?void 0:activityPlaceDetails.description)||activity.title,location:(activityPlaceDetails==null?void 0:activityPlaceDetails.address)||activity.title,duration:activity.duration,cost:activity.estimated_cost,placeId:activity.place_id,rating:activityPlaceDetails==null?void 0:activityPlaceDetails.rating,photo:activityPlaceDetails==null?void 0:activityPlaceDetails.photos_link,website:activityPlaceDetails==null?void 0:activityPlaceDetails.website,phone:activityPlaceDetails==null?void 0:activityPlaceDetails.phone,openingHours:activityPlaceDetails!=null&&activityPlaceDetails.operating_hours?JSON.stringify(activityPlaceDetails.operating_hours):void 0,reviews:activityPlaceDetails==null?void 0:activityPlaceDetails.reviews,types:activityPlaceDetails==null?void 0:activityPlaceDetails.types})}),(_j=plan.meals)==null||_j.forEach(meal=>{const mealPlaceDetails=placeDetails==null?void 0:placeDetails[meal.place_id];events.push({time:meal.time,type:"meal",title:meal.name,description:(mealPlaceDetails==null?void 0:mealPlaceDetails.description)||`Great ${meal.cuisine} cuisine`,location:(mealPlaceDetails==null?void 0:mealPlaceDetails.address)||meal.name,cuisine:meal.cuisine,priceRange:meal.price_range,placeId:meal.place_id,rating:mealPlaceDetails==null?void 0:mealPlaceDetails.rating,photo:mealPlaceDetails==null?void 0:mealPlaceDetails.photos_link,website:mealPlaceDetails==null?void 0:mealPlaceDetails.website,phone:mealPlaceDetails==null?void 0:mealPlaceDetails.phone,openingHours:mealPlaceDetails!=null&&mealPlaceDetails.operating_hours?JSON.stringify(mealPlaceDetails.operating_hours):void 0,reviews:mealPlaceDetails==null?void 0:mealPlaceDetails.reviews,types:mealPlaceDetails==null?void 0:mealPlaceDetails.types})}),plan.transportation&&(Array.isArray(plan.transportation)?plan.transportation:[plan.transportation]).forEach(transport=>{events.push({time:transport.from==="Hotel"?"Before next activity":"After previous activity",type:"transport",title:`${transport.method||transport.type} to ${transport.to}`,description:`Travel from ${transport.from} to ${transport.to}`,duration:transport.duration,cost:transport.cost})}),events.sort((a,b)=>a.time==="Before next activity"?-1:b.time==="Before next activity"||a.time==="After previous activity"?1:b.time==="After previous activity"?-1:a.time.localeCompare(b.time)),{day:plan.day,date:plan.date,theme:plan.theme,events}});setDaySchedules(schedules)},getEventIcon=type=>{switch(type){case"activity":return"ðŸŽ¯";case"meal":return"ðŸ½ï¸";case"transport":return"ðŸš—";case"checkin":return"ðŸ¨";case"checkout":return"âœˆï¸";default:return"ðŸ“"}},getEventColor=type=>{switch(type){case"activity":return"bg-blue-100 text-blue-800 border-blue-200";case"meal":return"bg-green-100 text-green-800 border-green-200";case"transport":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"checkin":return"bg-purple-100 text-purple-800 border-purple-200";case"checkout":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},formatDate=dateString=>new Date(dateString).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),handleRemoveEvent=(dayIndex,eventIndex)=>{const newDaySchedules=[...daySchedules];newDaySchedules[dayIndex].events.splice(eventIndex,1),setDaySchedules(newDaySchedules)},handleReplaceEvent=event=>{setSelectedEventToReplace(event),setShowAddPlaceModal(!0)},handleAddPlace=place=>{if(selectedEventToReplace){const newDaySchedules=[...daySchedules],dayIndex=newDaySchedules.findIndex(day=>day.events.some(event=>event===selectedEventToReplace)),eventIndex=newDaySchedules[dayIndex].events.findIndex(event=>event===selectedEventToReplace);dayIndex!==-1&&eventIndex!==-1&&(newDaySchedules[dayIndex].events[eventIndex]={time:selectedEventToReplace.time,type:selectedEventToReplace.type,title:place.title||"Unknown Place",description:place.description,location:place.address,duration:"2 hours",cost:"$50",placeId:place.place_id,rating:place.rating,photo:place.photos_link||place.thumbnail||place.serpapi_thumbnail,website:place.website,phone:place.phone,openingHours:place.operating_hours,reviews:place.reviews,types:place.types},setDaySchedules(newDaySchedules))}else{const newEvent={time:"14:00",type:"activity",title:place.title||"Unknown Place",description:place.description,location:place.address,duration:"2 hours",cost:"$50",placeId:place.place_id,rating:place.rating,photo:place.photos_link||place.thumbnail||place.serpapi_thumbnail,website:place.website,phone:place.phone,openingHours:place.operating_hours,reviews:place.reviews,types:place.types},newDaySchedules=[...daySchedules],dayIndex=newDaySchedules.findIndex(day=>day.day===selectedDay);dayIndex!==-1&&(newDaySchedules[dayIndex].events.push(newEvent),setDaySchedules(newDaySchedules))}setSelectedEventToReplace(null),setShowAddPlaceModal(!1)},handleSaveItinerary=async()=>{var _a2,_b2,_c,_d,_e,_f,_g,_h,_i,_j,_k,_l,_m,_n;if(itineraryData){if(!isAuthenticated||!user){alert("Please log in to save your itinerary."),navigate("/");return}setIsSaving(!0);try{console.log("Saving edited itinerary:",{itineraryData,daySchedules}),console.log("Budget estimate type:",typeof(((_a2=itineraryData.itinerary)==null?void 0:_a2.budget_estimate)||itineraryData.budget)),console.log("Budget estimate value:",((_b2=itineraryData.itinerary)==null?void 0:_b2.budget_estimate)||itineraryData.budget);const parseCost=value=>value==null?0:typeof value=="number"?value:typeof value=="string"&&parseFloat(value.replace("$","").replace(",",""))||0,saveData={title:`${((_c=itineraryData.itinerary)==null?void 0:_c.destination)||itineraryData.destination} Trip (Edited)`,description:`AI-generated itinerary for ${((_d=itineraryData.itinerary)==null?void 0:_d.destination)||itineraryData.destination} - Customized`,destination:((_e=itineraryData.itinerary)==null?void 0:_e.destination)||itineraryData.destination||"Unknown Destination",country:((_f=itineraryData.itinerary)==null?void 0:_f.destination)||itineraryData.destination||"Unknown Country",city:((_g=itineraryData.itinerary)==null?void 0:_g.destination)||itineraryData.destination||"Unknown City",duration_days:parseInt(String(((_h=itineraryData.itinerary)==null?void 0:_h.total_days)||itineraryData.duration_days))||1,start_date:((_i=daySchedules[0])==null?void 0:_i.date)||void 0,end_date:((_j=daySchedules[daySchedules.length-1])==null?void 0:_j.date)||void 0,budget:parseCost(((_k=itineraryData.itinerary)==null?void 0:_k.budget_estimate)||itineraryData.budget),travel_style:["leisure"],interests:[],days:daySchedules.length>0?daySchedules.map(daySchedule=>{const transportEvents=daySchedule.events.filter(event=>event.type==="transport"),accommodationEvents=daySchedule.events.filter(event=>event.type==="checkin"||event.type==="checkout");return{day_number:parseInt(String(daySchedule.day))||1,date:null,activities:daySchedule.events.filter(event=>event.type==="activity").map(event=>({name:event.title,time:event.time,location:event.location||event.title,description:event.description||event.title,cost:parseCost(event.cost)})),meals:daySchedule.events.filter(event=>event.type==="meal").map(event=>({name:event.title,time:event.time,location:event.location||event.title,description:event.description||event.title,cost:50})),transportation:transportEvents.length>0?{primary_method:transportEvents[0].title||"Transport",from:"Previous location",to:"Next location",duration:transportEvents[0].duration||"30 minutes",cost:parseCost(transportEvents[0].cost),all_transportation:transportEvents}:null,accommodations:accommodationEvents.length>0?{name:accommodationEvents[0].title,type:"hotel",cost_per_night:parseCost(accommodationEvents[0].cost)}:null,estimated_cost:parseFloat(daySchedule.events.reduce((sum,event)=>sum+parseCost(event.cost),0).toFixed(2))}}):[]};if(console.log("Sending edited save data:",JSON.stringify(saveData,null,2)),console.log("Transportation structure check:",saveData.days.map(day=>({day:day.day_number,transportation:day.transportation}))),!saveData.title||!saveData.destination||!saveData.country||!saveData.city)throw new Error("Missing required fields: title, destination, country, or city");if(saveData.days.length===0)throw new Error("No days data available to save");let savedItinerary;editMode==="saved"&&originalItineraryId?(savedItinerary=await savedItineraryAPI.updateItinerary(originalItineraryId,saveData),console.log("Saved itinerary updated successfully:",savedItinerary)):(savedItinerary=await savedItineraryAPI.createItinerary(saveData),console.log("New itinerary saved successfully:",savedItinerary)),setShowSaveConfirmation(!0),setTimeout(()=>{setShowSaveConfirmation(!1),navigate("/dashboard",{state:{activeTab:"trips"}})},3e3)}catch(error2){console.error("Error saving edited itinerary:",error2),console.error("Error details:",(_l=error2.response)==null?void 0:_l.data),alert(`Failed to save edited itinerary: ${((_n=(_m=error2.response)==null?void 0:_m.data)==null?void 0:_n.detail)||error2.message||"Unknown error"}`)}finally{setIsSaving(!1)}}};return isLoading?jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:jsxRuntimeExports.jsx(LoadingSpinner,{size:"lg",text:"Loading your itinerary..."})}):error||!itineraryData?jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:jsxRuntimeExports.jsxs(Card,{className:"p-8 text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Error"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:error||"No itinerary data found"}),jsxRuntimeExports.jsx("button",{onClick:()=>navigate("/"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Go Back Home"})]})}):jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[isScrolled&&jsxRuntimeExports.jsx("div",{className:"fixed top-0 left-0 right-0 z-50",children:jsxRuntimeExports.jsx(ModernHeader,{})}),jsxRuntimeExports.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-lg border-b border-gray-200 dark:border-gray-700 sticky top-0 z-50 w-full backdrop-blur-sm bg-white/95 dark:bg-gray-800/95",children:jsxRuntimeExports.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between py-1.5",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-4",children:[jsxRuntimeExports.jsx("button",{onClick:()=>navigate("/itinerary-generation",{state:{itineraryData,daySchedules}}),className:"p-3 rounded-xl bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 transition-all duration-200 group shadow-sm hover:shadow-md",children:jsxRuntimeExports.jsx(ArrowLeft,{className:"w-5 h-5 text-gray-600 dark:text-gray-300 group-hover:text-gray-800 dark:group-hover:text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center shadow-lg ${editMode==="saved"?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gradient-to-r from-green-500 to-green-600"}`,children:jsxRuntimeExports.jsx(PenLine,{className:"w-7 h-7 text-white"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[jsxRuntimeExports.jsxs("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:[editMode==="saved"?"Edit":"Customize"," ",((_a=itineraryData.itinerary)==null?void 0:_a.destination)||itineraryData.destination," Itinerary"]}),jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${editMode==="saved"?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300":"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300"}`,children:editMode==="saved"?"Saved":"Building"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-300",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center space-x-1",children:[jsxRuntimeExports.jsx(Calendar,{className:"w-4 h-4"}),jsxRuntimeExports.jsxs("span",{children:[((_b=itineraryData.itinerary)==null?void 0:_b.total_days)||itineraryData.duration_days," days"]})]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center space-x-1",children:[jsxRuntimeExports.jsx(Star,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:editMode==="saved"?"Modify your saved trip":"Customize your trip"})]}),editMode==="saved"&&jsxRuntimeExports.jsxs("span",{className:"flex items-center space-x-1",children:[jsxRuntimeExports.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),jsxRuntimeExports.jsx("span",{children:"Saved"})]})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>navigate("/results",{state:{injectedEnhancedResponse:itineraryData}}),className:"bg-green-600 text-white px-3 py-1.5 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-1.5 text-sm",children:[jsxRuntimeExports.jsx("span",{children:"ðŸ“…"}),jsxRuntimeExports.jsx("span",{children:"View Itinerary"})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>navigate("/itinerary",{state:{itineraryData}}),className:"bg-purple-600 text-white px-3 py-1.5 rounded-lg hover:bg-purple-700 transition-colors flex items-center space-x-1.5 text-sm",children:[jsxRuntimeExports.jsx("span",{children:"â°"}),jsxRuntimeExports.jsx("span",{children:"Timeline"})]}),jsxRuntimeExports.jsxs(ModernButton,{onClick:handleSaveItinerary,variant:"solid",className:`flex items-center space-x-2 px-4 py-2 shadow-lg hover:shadow-xl transition-all duration-200 ${editMode==="saved"?"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700":"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700"}`,disabled:isSaving,children:[isSaving?jsxRuntimeExports.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):jsxRuntimeExports.jsx(Save,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"font-medium text-sm",children:isSaving?editMode==="saved"?"Updating...":"Saving...":editMode==="saved"?"Update":"Save"})]})]})]})})}),jsxRuntimeExports.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 pt-4",children:jsxRuntimeExports.jsxs("div",{className:`inline-flex items-center space-x-2 px-4 py-2 rounded-full text-sm font-medium ${editMode==="saved"?"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300":"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300"}`,children:[jsxRuntimeExports.jsx("div",{className:`w-2 h-2 rounded-full ${editMode==="saved"?"bg-blue-500":"bg-green-500"}`}),jsxRuntimeExports.jsx("span",{children:editMode==="saved"?"Editing saved itinerary":"Building new itinerary"})]})}),jsxRuntimeExports.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-8",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-5 gap-8",children:[jsxRuntimeExports.jsx("div",{className:"xl:col-span-3 space-y-6",children:jsxRuntimeExports.jsxs(Card,{className:"p-6 shadow-lg border-0 bg-white dark:bg-gray-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900/20 rounded-lg flex items-center justify-center",children:jsxRuntimeExports.jsx(MapPin,{className:"w-5 h-5 text-blue-600"})}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Current Itinerary"})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center space-x-2",children:jsxRuntimeExports.jsxs("button",{onClick:()=>setShowAddPlaceModal(!0),className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 flex items-center space-x-2 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Add Place"})]})})]}),jsxRuntimeExports.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/10 rounded-lg border border-blue-200 dark:border-blue-800",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 text-blue-700 dark:text-blue-300",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",children:'Click on any event to replace it, or use "Add Place" to insert new places'})]})}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Select Day to Edit"}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[daySchedules.length," days total"]})]}),jsxRuntimeExports.jsx("div",{className:"flex space-x-4 overflow-x-auto pb-2",children:daySchedules.map(day=>{const isSelected=selectedDay===day.day;return jsxRuntimeExports.jsx("button",{onClick:()=>handleDaySelect(day.day),className:`px-6 py-4 rounded-xl text-sm font-medium whitespace-nowrap transition-colors duration-150 border-2 min-w-[140px] ${isSelected?"bg-blue-600 text-white border-blue-600 shadow-lg shadow-blue-600/25":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 border-transparent hover:border-gray-300 dark:hover:border-gray-500 hover:shadow-md"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsxs("span",{className:"font-semibold text-sm",children:["Day ",day.day]}),jsxRuntimeExports.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${isSelected?"bg-white/20 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300"}`,children:[day.events.length," events"]})]}),day.date&&jsxRuntimeExports.jsx("span",{className:`text-xs ${isSelected?"text-white/80":"text-gray-500 dark:text-gray-400"}`,children:new Date(day.date).toLocaleDateString()})]})},day.day)})})]}),currentDay&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsxs("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:["Day ",currentDay.day,": ",currentDay.theme]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:formatDate(currentDay.date)})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[currentDay.events.map((event,index)=>jsxRuntimeExports.jsxs("div",{className:"group relative flex items-start space-x-6 p-6 bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-500 transition-all duration-300 cursor-pointer hover:shadow-xl transform hover:-translate-y-1 hover:bg-gradient-to-r hover:from-blue-50 hover:to-indigo-50 dark:hover:from-gray-700 dark:hover:to-gray-600",onClick:()=>handleReplaceEvent(event),children:[jsxRuntimeExports.jsxs("div",{className:"flex-shrink-0 relative",children:[jsxRuntimeExports.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-lg shadow-md ${getEventColor(event.type)} border-2 border-white dark:border-gray-800 group-hover:scale-110 transition-transform duration-300`,children:getEventIcon(event.type)}),jsxRuntimeExports.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold",children:index+1})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:event.title}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[event.time&&jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-1 bg-white dark:bg-gray-700 px-2 py-1 rounded-full shadow-sm",children:[jsxRuntimeExports.jsx(Clock,{className:"w-3 h-3 text-gray-500"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:event.time})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[jsxRuntimeExports.jsx("button",{onClick:e=>{e.stopPropagation(),handleReplaceEvent(event)},className:"p-2 text-blue-600 hover:text-blue-700 hover:bg-blue-100 dark:hover:bg-blue-900/20 rounded-lg transition-all duration-200",title:"Replace this place",children:jsxRuntimeExports.jsx(Replace,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("button",{onClick:e=>{e.stopPropagation(),handleRemoveEvent(daySchedules.findIndex(day=>day.day===selectedDay),index)},className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-100 dark:hover:bg-red-900/20 rounded-lg transition-all duration-200",title:"Remove this place",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]})]})]}),event.description&&jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-3 line-clamp-2",children:event.description}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[event.location&&jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-1 bg-gray-100 dark:bg-gray-600 px-2 py-1 rounded-full",children:[jsxRuntimeExports.jsx(MapPin,{className:"w-3 h-3 text-gray-500"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:event.location})]}),event.duration&&jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-1 bg-gray-100 dark:bg-gray-600 px-2 py-1 rounded-full",children:[jsxRuntimeExports.jsx(Clock,{className:"w-3 h-3 text-gray-500"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:event.duration})]}),event.cost&&event.cost!=="0"&&jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-1 bg-green-100 dark:bg-green-900/20 px-2 py-1 rounded-full",children:[jsxRuntimeExports.jsx(DollarSign,{className:"w-3 h-3 text-green-600"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-green-600 dark:text-green-400",children:event.cost})]})]})]}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 rounded-xl border-2 border-dashed border-blue-300 dark:border-blue-400 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none",children:jsxRuntimeExports.jsx("div",{className:"absolute top-2 right-2 bg-blue-500 text-white text-xs px-2 py-1 rounded-full",children:"Click to replace"})})]},index)),jsxRuntimeExports.jsx("div",{className:"mt-6 p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl hover:border-blue-400 dark:hover:border-blue-500 transition-colors cursor-pointer group",onClick:()=>setShowAddPlaceModal(!0),children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center space-x-3 text-gray-500 dark:text-gray-400 group-hover:text-blue-500 dark:group-hover:text-blue-400",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center group-hover:bg-blue-100 dark:group-hover:bg-blue-900/20 transition-colors",children:jsxRuntimeExports.jsx(Plus,{className:"w-5 h-5"})}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Add a new place to this day"})]})})]})]})]})}),jsxRuntimeExports.jsx("div",{className:"xl:col-span-2 space-y-6",children:jsxRuntimeExports.jsxs(Card,{className:"p-6 shadow-lg border-0 bg-white dark:bg-gray-800",children:[jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-100 to-pink-100 dark:from-purple-900/30 dark:to-pink-900/30 rounded-xl flex items-center justify-center",children:jsxRuntimeExports.jsx(Search,{className:"w-6 h-6 text-purple-600"})}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Explore Places"})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Search,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Search places...",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent shadow-sm"})]})]}),itineraryData&&jsxRuntimeExports.jsx(AdditionalPlaces,{additionalPlaces:itineraryData.additional_places,onAddToItinerary:handleAddPlace,onPlaceHover:()=>{},onPlaceHoverLeave:()=>{}})]})})]})}),jsxRuntimeExports.jsx(PlaceDetailsModal,{place:selectedPlace,isOpen:isPlaceModalOpen,onClose:()=>setIsPlaceModalOpen(!1),onAddToItinerary:handleAddPlace,showAddButton:!0}),showAddPlaceModal&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 max-w-5xl mx-auto w-full max-h-[90vh] overflow-hidden flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:selectedEventToReplace?"Replace Place":"Add Place to Itinerary"}),jsxRuntimeExports.jsx("button",{onClick:()=>{setShowAddPlaceModal(!1),setSelectedEventToReplace(null)},className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsx("div",{className:"mb-4",children:jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Search for places to add...",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:itineraryData&&jsxRuntimeExports.jsx(AdditionalPlaces,{additionalPlaces:itineraryData.additional_places,onAddToItinerary:handleAddPlace,onPlaceHover:()=>{},onPlaceHoverLeave:()=>{},enablePagination:!0})}),jsxRuntimeExports.jsx("div",{className:"mt-4 flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:jsxRuntimeExports.jsx("button",{onClick:()=>{setShowAddPlaceModal(!1),setSelectedEventToReplace(null)},className:"px-4 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors font-medium",children:"Cancel"})})]})}),jsxRuntimeExports.jsx("div",{className:"fixed bottom-6 right-6 z-40",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col space-y-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>setShowAddPlaceModal(!0),className:"w-14 h-14 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center group transform hover:scale-110",title:"Add Place",children:jsxRuntimeExports.jsx(Plus,{className:"w-6 h-6 group-hover:rotate-90 transition-transform duration-200"})}),jsxRuntimeExports.jsx("button",{onClick:handleSaveItinerary,disabled:isSaving,className:`w-14 h-14 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center group transform hover:scale-110 ${editMode==="saved"?"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700":"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700"} ${isSaving?"opacity-50 cursor-not-allowed":""}`,title:editMode==="saved"?"Update Itinerary":"Save Itinerary",children:isSaving?jsxRuntimeExports.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}):jsxRuntimeExports.jsx(Save,{className:"w-6 h-6 group-hover:scale-110 transition-transform duration-200"})})]})}),showSaveConfirmation&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 max-w-md mx-4 text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:jsxRuntimeExports.jsx(CheckCircle,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),jsxRuntimeExports.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:editMode==="saved"?"Itinerary Updated!":"Itinerary Saved!"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:editMode==="saved"?"Your itinerary has been updated successfully.":"Your itinerary has been saved successfully. You can find it in your dashboard."}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center space-x-2 text-sm text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse"}),jsxRuntimeExports.jsx("span",{children:"Redirecting to your trips..."})]})]})}),(itineraryData==null?void 0:itineraryData.id)&&jsxRuntimeExports.jsx(CollaborationChat,{itineraryId:itineraryData.id})]})};export{EditItineraryPage as default};
