import{b as useToast,u as useAuth,j as jsxRuntimeExports,M as ModernButton,m as motion}from"./index-lko4Hfbd.js";import{r as reactExports}from"./vendor-WBEadHvS.js";import{d as useSearchParams,u as useNavigate,L as Link}from"./router-BTz3HJhu.js";import{J as AlertCircle,L as Lock,E as EyeOff,a as Eye,c as CheckCircle,e as ArrowLeft}from"./ui-B24o0VU9.js";const ResetPasswordPage=()=>{const[searchParams]=useSearchParams(),navigate=useNavigate(),{showSuccess,showError}=useToast(),{resetPassword}=useAuth(),[formData,setFormData]=reactExports.useState({token:"",new_password:"",confirm_password:""}),[showPassword,setShowPassword]=reactExports.useState(!1),[showConfirmPassword,setShowConfirmPassword]=reactExports.useState(!1),[isSubmitting,setIsSubmitting]=reactExports.useState(!1),[isValidating,setIsValidating]=reactExports.useState(!0),[isTokenValid,setIsTokenValid]=reactExports.useState(!1),[errors,setErrors]=reactExports.useState({});reactExports.useEffect(()=>{const token=searchParams.get("token");if(!token){showError("Invalid reset link. Please request a new password reset."),navigate("/forgot-password");return}setFormData(prev=>({...prev,token})),setIsValidating(!1),setIsTokenValid(!0)},[searchParams,navigate,showError]);const validateForm=()=>{const newErrors={};return formData.new_password.trim()?formData.new_password.length<8?newErrors.new_password="Password must be at least 8 characters long":formData.new_password.length>128?newErrors.new_password="Password is too long (max 128 characters)":/(?=.*[a-z])/.test(formData.new_password)?/(?=.*[A-Z])/.test(formData.new_password)?/(?=.*\d)/.test(formData.new_password)||(newErrors.new_password="Password must contain at least one number"):newErrors.new_password="Password must contain at least one uppercase letter":newErrors.new_password="Password must contain at least one lowercase letter":newErrors.new_password="New password is required",formData.confirm_password.trim()?formData.new_password!==formData.confirm_password&&(newErrors.confirm_password="Passwords do not match"):newErrors.confirm_password="Please confirm your password",setErrors(newErrors),Object.keys(newErrors).length===0},handleSubmit=async e=>{if(e.preventDefault(),!!validateForm()){setIsSubmitting(!0);try{await resetPassword(formData),showSuccess("Password reset successfully! You can now log in with your new password."),navigate("/login")}catch(error){console.error("Password reset error:",error),showError(error.message||"Failed to reset password. Please try again.")}finally{setIsSubmitting(!1)}}},handleInputChange=e=>{const{name,value}=e.target;setFormData(prev=>({...prev,[name]:value})),errors[name]&&setErrors(prev=>({...prev,[name]:void 0}))};return isValidating?jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:jsxRuntimeExports.jsx("div",{className:"w-full max-w-md",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 text-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Validating reset link..."})]})})}):isTokenValid?jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:jsxRuntimeExports.jsx("div",{className:"w-full max-w-md",children:jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-xl p-8",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-8",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-primary-500 to-purple-600 rounded-xl flex items-center justify-center mx-auto mb-4",children:jsxRuntimeExports.jsx(Lock,{className:"w-8 h-8 text-white"})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Reset Your Password"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Enter your new password below"})]}),jsxRuntimeExports.jsxs("form",{onSubmit:handleSubmit,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"new_password",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("input",{type:showPassword?"text":"password",id:"new_password",name:"new_password",value:formData.new_password,onChange:handleInputChange,className:`w-full px-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-primary-500/20 focus:border-primary-500 transition-all duration-200 bg-white/90 backdrop-blur-sm placeholder:text-sm ${errors.new_password?"border-red-300 focus:border-red-500 focus:ring-red-500/20":"border-gray-200 hover:border-gray-300"}`,placeholder:"Enter your new password",disabled:isSubmitting}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>setShowPassword(!showPassword),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",disabled:isSubmitting,children:showPassword?jsxRuntimeExports.jsx(EyeOff,{className:"w-5 h-5"}):jsxRuntimeExports.jsx(Eye,{className:"w-5 h-5"})})]}),errors.new_password&&jsxRuntimeExports.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[jsxRuntimeExports.jsx(AlertCircle,{className:"w-4 h-4 mr-1"}),errors.new_password]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"confirm_password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("input",{type:showConfirmPassword?"text":"password",id:"confirm_password",name:"confirm_password",value:formData.confirm_password,onChange:handleInputChange,className:`w-full px-4 py-3 border-2 rounded-xl focus:ring-4 focus:ring-primary-500/20 focus:border-primary-500 transition-all duration-200 bg-white/90 backdrop-blur-sm placeholder:text-sm ${errors.confirm_password?"border-red-300 focus:border-red-500 focus:ring-red-500/20":"border-gray-200 hover:border-gray-300"}`,placeholder:"Confirm your new password",disabled:isSubmitting}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>setShowConfirmPassword(!showConfirmPassword),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",disabled:isSubmitting,children:showConfirmPassword?jsxRuntimeExports.jsx(EyeOff,{className:"w-5 h-5"}):jsxRuntimeExports.jsx(Eye,{className:"w-5 h-5"})})]}),errors.confirm_password&&jsxRuntimeExports.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[jsxRuntimeExports.jsx(AlertCircle,{className:"w-4 h-4 mr-1"}),errors.confirm_password]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Password Requirements:"}),jsxRuntimeExports.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[jsxRuntimeExports.jsxs("li",{className:"flex items-center",children:[jsxRuntimeExports.jsx(CheckCircle,{className:`w-4 h-4 mr-2 ${formData.new_password.length>=8?"text-green-500":"text-gray-400"}`}),"At least 8 characters"]}),jsxRuntimeExports.jsxs("li",{className:"flex items-center",children:[jsxRuntimeExports.jsx(CheckCircle,{className:`w-4 h-4 mr-2 ${formData.new_password===formData.confirm_password&&formData.confirm_password?"text-green-500":"text-gray-400"}`}),"Passwords match"]})]})]}),jsxRuntimeExports.jsx(ModernButton,{type:"submit",loading:isSubmitting,className:"w-full bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm",size:"md",disabled:isSubmitting,children:isSubmitting?"Resetting Password...":"Reset Password"})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 text-center",children:jsxRuntimeExports.jsxs(Link,{to:"/login",className:"inline-flex items-center text-sm text-gray-600 hover:text-primary-600 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-1"}),"Back to Sign In"]})})]})})}):jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:jsxRuntimeExports.jsx("div",{className:"w-full max-w-md",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:jsxRuntimeExports.jsx(AlertCircle,{className:"w-8 h-8 text-red-500"})}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Invalid Reset Link"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mb-6",children:"This password reset link is invalid or has expired. Please request a new one."}),jsxRuntimeExports.jsx(Link,{to:"/forgot-password",children:jsxRuntimeExports.jsx(ModernButton,{className:"w-full",children:"Request New Reset Link"})})]})})})};export{ResetPasswordPage as default};
